<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CROWN SUMMIT | THE ELITE 100</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Montserrat:wght@300;400&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg: #030303;
            --gold: #D4AF37;
            --gold-low: rgba(212, 175, 55, 0.2);
            --gold-bright: #FFD700;
            --glass: rgba(255, 255, 255, 0.03);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: var(--bg); color: #fff; font-family: 'Montserrat', sans-serif; 
            overflow: hidden; height: 100vh;
        }

        /* Ambient Background */
        #bg-canvas { position: fixed; top: 0; left: 0; z-index: -1; width: 100%; height: 100%; opacity: 0.4; }

        /* Navigation */
        .header-nav {
            position: fixed; top: 0; width: 100%; padding: 30px 50px;
            display: flex; justify-content: space-between; align-items: center; z-index: 1000;
        }
        .nav-back {
            text-decoration: none; color: var(--gold); font-family: 'Cinzel';
            font-size: 11px; letter-spacing: 3px; display: flex; align-items: center; gap: 10px;
            transition: 0.3s;
        }
        .nav-back:hover { color: #fff; text-shadow: 0 0 10px var(--gold); }

        /* Title Overlay */
        .level-tag {
            position: absolute; top: 120px; width: 100%; text-align: center;
            font-family: 'Cinzel'; font-size: clamp(20px, 5vw, 40px);
            letter-spacing: 15px; color: var(--gold); opacity: 0.2; pointer-events: none;
        }

        /* Map UI */
        .map-viewport {
            height: 100vh; width: 100vw; display: flex; justify-content: center;
            align-items: center; perspective: 1200px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(10, 55px);
            gap: 12px;
            transform: rotateX(25deg) rotateZ(-5deg);
            transition: 0.8s cubic-bezier(0.2, 1, 0.3, 1);
        }
        
        @media (max-width: 768px) {
            .grid-container { 
                grid-template-columns: repeat(5, 50px); 
                transform: rotateX(15deg);
            }
        }

        /* Hexagon Plot Design */
        .plot {
            width: 55px; height: 62px; background: var(--glass);
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            border: 1px solid var(--gold-low); position: relative;
            cursor: pointer; transition: 0.4s;
            display: flex; justify-content: center; align-items: center;
            font-size: 9px; color: var(--gold); font-family: 'Cinzel';
        }

        .plot:hover {
            transform: scale(1.4) translateZ(40px);
            background: var(--gold); color: #000;
            box-shadow: 0 0 30px var(--gold); z-index: 100;
        }

        /* Status: SOLD */
        .plot.sold { border-color: var(--gold-bright); background: rgba(212, 175, 55, 0.1); }
        .plot.sold i { font-size: 12px; filter: drop-shadow(0 0 5px var(--gold)); }

        /* Information Card (Bottom Right) */
        .info-card {
            position: fixed; bottom: 40px; right: 40px; width: 340px;
            background: rgba(5, 5, 5, 0.9); border: 1px solid var(--gold-low);
            border-top: 3px solid var(--gold); padding: 30px; 
            backdrop-filter: blur(20px); opacity: 0; transform: translateY(20px);
            transition: 0.5s; pointer-events: none; z-index: 2000;
        }
        .plot:hover ~ .info-card, .info-card.active { opacity: 1; transform: translateY(0); pointer-events: all; }

        .cust-profile { display: flex; align-items: center; gap: 20px; margin-bottom: 20px; }
        .cust-img { 
            width: 70px; height: 70px; border-radius: 50%; 
            border: 2px solid var(--gold); object-fit: cover; background: #111;
        }
        .cust-meta h3 { font-family: 'Cinzel'; font-size: 18px; color: var(--gold); }
        .cust-meta p { font-size: 10px; text-transform: uppercase; color: #777; letter-spacing: 1px; }

        .cust-msg { font-size: 13px; color: #ccc; line-height: 1.6; margin-bottom: 20px; font-style: italic; }
        .cust-btn {
            display: block; width: 100%; padding: 12px; text-align: center;
            background: var(--gold); color: #000; text-decoration: none;
            font-family: 'Cinzel'; font-size: 11px; font-weight: bold; transition: 0.3s;
        }
        .cust-btn:hover { background: #fff; box-shadow: 0 0 20px rgba(255,255,255,0.4); }

        #loader { 
            position: fixed; inset: 0; background: #000; z-index: 99999; 
            display: flex; justify-content: center; align-items: center; transition: 1s;
        }
    </style>
</head>
<body>

    <div id="loader">
        <h2 style="color:var(--gold); font-family:'Cinzel'; letter-spacing: 10px;">INITIALIZING CROWN SUMMIT...</h2>
    </div>

    <canvas id="bg-canvas"></canvas>

    <header class="header-nav">
        <a href="index.html" class="nav-back"><i class="fa-solid fa-chevron-left"></i> BACK TO ARK</a>
        <div style="font-family:'Cinzel'; font-size: 10px; color: var(--gold); letter-spacing: 2px;">SECURE FIREBASE NODE: ACTIVE</div>
    </header>

    <div class="level-tag">CROWN SUMMIT</div>

    <div class="map-viewport">
        <div class="grid-container" id="plotGrid">
            </div>

        <div class="info-card" id="infoCard">
            <div class="cust-profile">
                <img src="" id="infoImg" class="cust-img">
                <div class="cust-meta">
                    <p>Legacy Guardian</p>
                    <h3 id="infoName">---</h3>
                </div>
            </div>
            <p class="cust-msg" id="infoMsg">Select a plot to view its eternal guardian's message.</p>
            <a href="#" id="infoLink" target="_blank" class="cust-btn">ENTER GUARDIAN'S REALM</a>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCAdnfu2R82xbC7H85n_9mvQBE58X3TjbA",
            authDomain: "the-5k-elite-legacy.firebaseapp.com",
            databaseURL: "https://the-5k-elite-legacy-default-rtdb.firebaseio.com",
            projectId: "the-5k-elite-legacy",
            storageBucket: "the-5k-elite-legacy.firebasestorage.app",
            messagingSenderId: "440824313752",
            appId: "1:440824313752:web:2c93344dcfe2ba0a4c5ded"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        const grid = document.getElementById('plotGrid');
        const infoCard = document.getElementById('infoCard');
        const infoName = document.getElementById('infoName');
        const infoImg = document.getElementById('infoImg');
        const infoMsg = document.getElementById('infoMsg');
        const infoLink = document.getElementById('infoLink');

        // Fetch Live Data
        const plotsRef = ref(db, 'crown_summit');
        onValue(plotsRef, (snapshot) => {
            const data = snapshot.val() || {};
            buildGrid(data);
            document.getElementById('loader').style.opacity = '0';
            setTimeout(() => document.getElementById('loader').style.display = 'none', 1000);
        });

        function buildGrid(data) {
            grid.innerHTML = '';
            for (let i = 1; i <= 100; i++) {
                const plot = document.createElement('div');
                plot.className = 'plot';
                const pData = data[i];

                if (pData) {
                    plot.classList.add('sold');
                    plot.innerHTML = `<i class="fa-solid fa-crown"></i>`;
                } else {
                    plot.innerHTML = i;
                }

                plot.onmouseenter = () => {
                    if (pData) {
                        infoName.innerText = pData.name;
                        infoImg.src = pData.image;
                        infoMsg.innerText = pData.message || "A silent guardian of the Eternal Ark.";
                        infoLink.href = pData.link;
                        infoLink.style.display = 'block';
                        infoCard.style.opacity = '1';
                    } else {
                        infoName.innerText = "AVAILABLE PLOT";
                        infoImg.src = "https://via.placeholder.com/70/111/D4AF37?text=ARK";
                        infoMsg.innerText = "This Master Plot is vacant. Price: $999. Contact support to claim.";
                        infoLink.style.display = 'none';
                        infoCard.style.opacity = '1';
                    }
                };

                grid.appendChild(plot);
            }
        }

        // Particle Background Logic
        const canvas = document.getElementById('bg-canvas');
        const ctx = canvas.getContext('2d');
        let stars = [];
        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.onresize = resize; resize();
        for(let i=0; i<150; i++) stars.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, r: Math.random()*1.5 });
        function draw() {
            ctx.clearRect(0,0,canvas.width, canvas.height); ctx.fillStyle = "rgba(212, 175, 55, 0.4)";
            stars.forEach(s => { ctx.beginPath(); ctx.arc(s.x, s.y, s.r, 0, Math.PI*2); ctx.fill(); });
            requestAnimationFrame(draw);
        }
        draw();
    </script>
</body>
</html>
