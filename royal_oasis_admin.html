<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMIN | ROYAL OASIS V2</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Plus+Jakarta+Sans:wght@400;600&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root {
            --bg: #050505;
            --gold: #D4AF37;
            --cyan: #00FFCC;
            --card: #111;
        }

        body {
            background-color: var(--bg);
            color: #fff;
            font-family: 'Plus Jakarta Sans', sans-serif;
            margin: 0;
            padding: 20px;
        }

        h1 { font-family: 'Cinzel'; color: var(--cyan); letter-spacing: 5px; text-align: center; margin-bottom: 40px; }

        .admin-container {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .panel-box {
            background: var(--card);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid #222;
        }

        h3 { font-family: 'Cinzel'; color: var(--gold); margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 10px; }

        /* Form Elements */
        label { display: block; font-size: 12px; color: #888; margin-bottom: 5px; }
        input {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            background: #000;
            border: 1px solid #333;
            color: #fff;
            outline: none;
            border-radius: 5px;
        }

        .btn-update {
            width: 100%;
            padding: 15px;
            background: var(--cyan);
            color: #000;
            border: none;
            font-weight: 900;
            font-family: 'Cinzel';
            cursor: pointer;
            transition: 0.3s;
        }

        .btn-update:hover { background: #fff; box-shadow: 0 0 20px var(--cyan); }

        /* Order List */
        .order-item {
            background: #000;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 3px solid var(--cyan);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .order-info b { color: var(--cyan); }
        .btn-delete {
            background: #ff4444;
            color: #fff;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 10px;
        }

        @media (max-width: 850px) {
            .admin-container { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <h1>ROYAL OASIS COMMAND CENTER</h1>

    <div class="admin-container">
        
        <div class="panel-box">
            <h3>MANAGE PLOTS</h3>
            <label>PLOT NUMBER (1-35)</label>
            <input type="number" id="plotId" placeholder="e.g. 1">
            
            <label>BRAND LOGO URL</label>
            <input type="text" id="imgUrl" placeholder="https://image-link.com/logo.png">
            
            <label>WEBSITE LINK (Optional)</label>
            <input type="text" id="siteLink" placeholder="https://brandwebsite.com">
            
            <button class="btn-update" onclick="updatePlot()">ACTIVATE PLOT</button>
            
            <p style="margin-top: 30px; font-size: 11px; color: #555;">
                * To clear a plot, enter the Plot Number and leave Logo URL empty, then click Update.
            </p>
        </div>

        <div class="panel-box">
            <h3>LATEST ORDERS</h3>
            <div id="orderList">
                <p style="color: #444;">Monitoring live requests...</p>
            </div>
        </div>

    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCAdnfu2R82xbC7H85n_9mvQBE58X3TjbA",
            authDomain: "the-5k-elite-legacy.firebaseapp.com",
            databaseURL: "https://the-5k-elite-legacy-default-rtdb.firebaseio.com",
            projectId: "the-5k-elite-legacy",
            storageBucket: "the-5k-elite-legacy.firebasestorage.app",
            messagingSenderId: "440824313752",
            appId: "1:440824313752:web:2c93344dcfe2ba0a4c5ded"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // ১. প্লট আপডেট করা (V2 পাথ)
        function updatePlot() {
            const id = document.getElementById('plotId').value;
            const url = document.getElementById('imgUrl').value;
            const link = document.getElementById('siteLink').value || "#";

            if(!id) return alert("Enter Plot Number");

            if(url === "") {
                // লোগো না দিলে ডিলিট হবে
                db.ref('royal_oasis_v2/live/' + id).remove()
                .then(() => alert("Plot #" + id + " has been cleared."));
            } else {
                // লোগো দিলে আপডেট হবে
                db.ref('royal_oasis_v2/live/' + id).set({
                    imageUrl: url,
                    link: link,
                    name: "Active Plot"
                }).then(() => {
                    alert("Plot #" + id + " is now LIVE!");
                    document.getElementById('imgUrl').value = "";
                });
            }
        }

        // ২. লাইভ অর্ডার মনিটর করা
        function fetchOrders() {
            db.ref('royal_oasis_v2/orders').limitToLast(10).on('value', snapshot => {
                const orders = snapshot.val();
                const listDiv = document.getElementById('orderList');
                listDiv.innerHTML = "";

                if(!orders) {
                    listDiv.innerHTML = "<p style='color:#444;'>No orders found.</p>";
                    return;
                }

                Object.keys(orders).reverse().forEach(key => {
                    const order = orders[key];
                    const item = document.createElement('div');
                    item.className = 'order-item';
                    item.innerHTML = `
                        <div class="order-info">
                            <b>#${order.plot}</b> - ${order.brand} <br>
                            <small style="color:#555;">Value: $${order.price}</small>
                        </div>
                        <button class="btn-delete" onclick="deleteOrder('${key}')">Archive</button>
                    `;
                    listDiv.appendChild(item);
                });
            });
        }

        function deleteOrder(key) {
            if(confirm("Archive this order?")) {
                db.ref('royal_oasis_v2/orders/' + key).remove();
            }
        }

        window.onload = fetchOrders;
    </script>
</body>
</html>
